---
description: Next.js 성능 최적화 규칙 - 이미지, 폰트, 메타데이터, 번들 최적화
globs: ["**/*.tsx", "**/*.ts", "**/layout.tsx", "**/page.tsx"]
alwaysApply: true
---

# 성능 최적화

## 이미지 최적화

- **항상 `next/image` 사용** (`<img>` 태그 비사용)
- `width`, `height` 명시 (레이아웃 시프트 방지)
- `priority` 속성은 Above-the-fold 이미지에만 사용
- `placeholder="blur"` 사용 고려
- 적절한 `sizes` 속성 설정

```typescript
import Image from 'next/image';

<Image
  src="/image.jpg"
  alt="Description"
  width={800}
  height={600}
  priority // 첫 화면에만
  placeholder="blur"
  sizes="(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw"
/>
```

## 폰트 최적화

- **`next/font` 사용** (Google Fonts, 로컬 폰트)
- `variable` 속성으로 CSS 변수 사용
- `display: 'swap'` 설정

```typescript
import { Inter } from 'next/font/google';

const inter = Inter({
  subsets: ['latin'],
  display: 'swap',
  variable: '--font-inter',
});
```

## 메타데이터 API

- **메타데이터는 `metadata` 객체 또는 `generateMetadata` 함수 사용**
- SEO 최적화를 위한 메타데이터 필수 설정

```typescript
export const metadata = {
  title: 'Portfolio',
  description: 'My portfolio site',
  openGraph: {
    title: 'Portfolio',
    description: 'My portfolio site',
    images: ['/og-image.jpg'],
  },
};
```

## 번들 최적화

- 동적 import 사용 (`next/dynamic`)
- 큰 라이브러리는 필요할 때만 로드
- `loading` 속성으로 로딩 상태 처리

```typescript
import dynamic from 'next/dynamic';

const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <p>Loading...</p>,
  ssr: false, // 필요시에만
});
```
